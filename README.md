# æ™šä¼šç½‘ç«™ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ™šä¼šäº’åŠ¨ç½‘ç«™ç³»ç»Ÿï¼ŒåŒ…å«Guestç«¯å’ŒAdminç«¯ï¼Œæ”¯æŒæŠ½å¥–ã€å¼¹å¹•ã€èŠ‚ç›®è¿›åº¦ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### Guestç«¯ï¼ˆè§‚ä¼—ç«¯ï¼‰
- ğŸ¨ **ä¸»é¡µ**ï¼šå±•ç¤ºæ™šä¼šæµ·æŠ¥ï¼Œæä¾›å¯¼èˆªå…¥å£
- ğŸ **æŠ½å¥–æ˜¾ç¤º**ï¼šå®æ—¶æŸ¥çœ‹ä¸­å¥–å·ç 
- ğŸ’¬ **å¼¹å¹•å‘é€**ï¼šå‘é€å¼¹å¹•äº’åŠ¨
- ğŸ“‹ **èŠ‚ç›®è¿›åº¦**ï¼šæŸ¥çœ‹èŠ‚ç›®å•å’Œå½“å‰è¿›åº¦
- ğŸ“± **ç§»åŠ¨ç«¯é€‚é…**ï¼šå®Œç¾æ”¯æŒæ‰‹æœºè®¿é—®

### Adminç«¯ï¼ˆç®¡ç†å‘˜ç«¯ï¼‰
- ğŸ” **å®‰å…¨ç™»å½•**ï¼šå¯†ç è®¤è¯ + JWT Tokené‰´æƒ
- ğŸ“‹ **èŠ‚ç›®ç®¡ç†**ï¼šç®¡ç†èŠ‚ç›®å•å’Œè¿›åº¦
- ğŸ’¬ **å¼¹å¹•ç®¡ç†**ï¼šå®æ—¶æŸ¥çœ‹å’Œç®¡ç†å¼¹å¹•
- ğŸ **æŠ½å¥–ç®¡ç†**ï¼šé…ç½®æŠ½å¥–å‚æ•°å¹¶è¿›è¡ŒæŠ½å¥–
- ğŸ² **æŠ½å¥–åŠ¨ç”»**ï¼šæ»šåŠ¨æ•°å­—åŠ¨ç”»æ•ˆæœ

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 14 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **è®¤è¯**: JWT + bcryptjs
- **å­˜å‚¨**: JSONæ–‡ä»¶æŒä¹…åŒ–å­˜å‚¨

## å®‰è£…å’Œè¿è¡Œ

### å‰ææ¡ä»¶

ç¡®ä¿å·²å®‰è£… Node.js 18+ å’Œ npmã€‚

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼Œè®¾ç½®ç®¡ç†å‘˜å¯†ç ï¼š

```bash
# ä½¿ç”¨ bcrypt ç”Ÿæˆå¯†ç å“ˆå¸Œ
# é»˜è®¤å¯†ç : admin123
ADMIN_PASSWORD_HASH=$2a$10$YourHashHere
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
```

### ç”Ÿæˆå¯†ç å“ˆå¸Œ

ä½¿ç”¨ Node.js ç”Ÿæˆå¯†ç å“ˆå¸Œï¼š

```bash
node -e "const bcrypt = require('bcryptjs'); bcrypt.hash('your-password', 10).then(console.log);"
```

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è®¿é—® `http://localhost:3000`

### ç”Ÿäº§æ„å»º

```bash
npm run build
npm start
```

## ä½¿ç”¨æŒ‡å—

### Guestç«¯è®¿é—®

1. è®¿é—®ä¸»é¡µ: `http://localhost:3000`
2. æ‰«æäºŒç»´ç æˆ–ç›´æ¥è®¿é—®ä»¥ä¸‹é¡µé¢ï¼š
   - æŠ½å¥–ç»“æœ: `/lottery`
   - å‘é€å¼¹å¹•: `/danmaku`
   - èŠ‚ç›®è¿›åº¦: `/programs`

### Adminç«¯è®¿é—®

1. è®¿é—®ç®¡ç†å‘˜ç™»å½•: `http://localhost:3000/admin`
2. è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼ˆé»˜è®¤ï¼šadmin123ï¼‰
3. è¿›å…¥æ§åˆ¶å°ç®¡ç†å„é¡¹åŠŸèƒ½

## APIæ¥å£

### å…¬å¼€API

- `GET /api/programs` - è·å–èŠ‚ç›®å•
- `GET /api/lottery/result` - è·å–æŠ½å¥–ç»“æœ
- `POST /api/danmaku` - å‘é€å¼¹å¹•

### ç®¡ç†å‘˜APIï¼ˆéœ€è¦Tokenï¼‰

- `POST /api/admin/login` - ç®¡ç†å‘˜ç™»å½•
- `POST /api/programs` - æ›´æ–°èŠ‚ç›®å•
- `PATCH /api/programs` - æ›´æ–°èŠ‚ç›®çŠ¶æ€
- `GET /api/danmaku` - è·å–å¼¹å¹•åˆ—è¡¨
- `DELETE /api/danmaku` - æ¸…ç©ºå¼¹å¹•
- `GET /api/lottery/config` - è·å–æŠ½å¥–é…ç½®
- `POST /api/lottery/config` - æ›´æ–°æŠ½å¥–é…ç½®
- `POST /api/lottery/result` - å‘å¸ƒæŠ½å¥–ç»“æœ

## ç›®å½•ç»“æ„

```
lueying/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ api/                  # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ admin/            # ç®¡ç†å‘˜ç›¸å…³API
â”‚   â”‚   â”œâ”€â”€ danmaku/          # å¼¹å¹•API
â”‚   â”‚   â”œâ”€â”€ lottery/          # æŠ½å¥–API
â”‚   â”‚   â””â”€â”€ programs/         # èŠ‚ç›®å•API
â”‚   â”œâ”€â”€ admin/                # Adminç«¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ dashboard/        # æ§åˆ¶å°
â”‚   â”‚   â”œâ”€â”€ programs/         # èŠ‚ç›®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ danmaku/          # å¼¹å¹•ç®¡ç†
â”‚   â”‚   â””â”€â”€ lottery/          # æŠ½å¥–ç®¡ç†
â”‚   â”œâ”€â”€ danmaku/              # Guestå¼¹å¹•é¡µé¢
â”‚   â”œâ”€â”€ lottery/              # GuestæŠ½å¥–é¡µé¢
â”‚   â”œâ”€â”€ programs/             # GuestèŠ‚ç›®é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx            # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx              # ä¸»é¡µ
â”‚   â””â”€â”€ globals.css           # å…¨å±€æ ·å¼
â”œâ”€â”€ lib/                      # å·¥å…·åº“
â”‚   â”œâ”€â”€ auth.ts               # è®¤è¯å·¥å…·
â”‚   â””â”€â”€ dataStore.ts          # æ•°æ®å­˜å‚¨
â”œâ”€â”€ types/                    # TypeScriptç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ next.config.js
```

## å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼šé¦–æ¬¡éƒ¨ç½²å‰åŠ¡å¿…ä¿®æ”¹ `.env.local` ä¸­çš„ç®¡ç†å‘˜å¯†ç 
2. **JWTå¯†é’¥**ï¼šä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²ä½œä¸ºJWT_SECRET
3. **HTTPS**ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨HTTPS
4. **æ•°æ®åº“**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨çœŸå®æ•°æ®åº“æ›¿ä»£å†…å­˜å­˜å‚¨

## æ‰©å±•å»ºè®®

### æŒä¹…åŒ–å­˜å‚¨

å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œé‡å¯åæ•°æ®ä¼šä¸¢å¤±ã€‚å»ºè®®é›†æˆï¼š
- **SQLite**: è½»é‡çº§åœºæ™¯
- **PostgreSQL/MySQL**: ç”Ÿäº§ç¯å¢ƒ
- **MongoDB**: NoSQLæ–¹æ¡ˆ

### å®æ—¶æ›´æ–°

é›†æˆWebSocketæˆ–Server-Sent Eventså®ç°ï¼š
- å¼¹å¹•å®æ—¶æ¨é€
- èŠ‚ç›®è¿›åº¦å®æ—¶åŒæ­¥
- æŠ½å¥–ç»“æœå®æ—¶é€šçŸ¥

### äºŒç»´ç ç”Ÿæˆ

ä¸ºGuestç«¯é¡µé¢ç”ŸæˆäºŒç»´ç ï¼š

```bash
npm install qrcode
```

## License

MIT

## ä½œè€…

æ™šä¼šç½‘ç«™ç³»ç»Ÿ Â© 2025
