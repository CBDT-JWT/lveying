# 节目信息 KaTeX 数学公式支持

## ✨ 新增功能

节目详情现在支持使用 KaTeX 渲染数学公式，可以在节目介绍中添加美观的数学表达式。

## 📐 支持的公式类型

### 1. 行内公式
使用单个 `$` 包裹公式，公式会在文本行内显示。

**语法**：
```
这是行内公式：$E=mc^2$
```

**效果**：
这是行内公式：E=mc²

### 2. 块级公式（居中显示）
使用双 `$$` 包裹公式，公式会单独成行并居中显示。

**语法**：
```
勾股定理：

$$a^2 + b^2 = c^2$$
```

**效果**：
勾股定理：

（公式居中显示）
a² + b² = c²

## 📝 常用数学符号

### 基础运算
- 加法：`+` → +
- 减法：`-` → −
- 乘法：`\times` → ×
- 除法：`\div` → ÷
- 等于：`=` → =
- 不等于：`\neq` → ≠
- 约等于：`\approx` → ≈

### 上下标
- 上标：`x^2` → x²
- 下标：`x_i` → xᵢ
- 上下标组合：`x_i^2` → xᵢ²
- 复杂上标：`x^{2y}` → x^(2y)

### 分数
- 简单分数：`\frac{1}{2}` → ½
- 复杂分数：`\frac{a+b}{c+d}` → (a+b)/(c+d)

### 根号
- 平方根：`\sqrt{2}` → √2
- n次根：`\sqrt[3]{8}` → ³√8

### 求和与积分
- 求和：`\sum_{i=1}^{n} i` → Σ(i=1到n) i
- 积分：`\int_0^1 x dx` → ∫₀¹ x dx
- 无穷：`\infty` → ∞

### 希腊字母
- α：`\alpha`
- β：`\beta`
- π：`\pi`
- Σ：`\Sigma`
- Δ：`\Delta`
- θ：`\theta`
- λ：`\lambda`
- μ：`\mu`

### 特殊符号
- 小于等于：`\leq` → ≤
- 大于等于：`\geq` → ≥
- 属于：`\in` → ∈
- 任意：`\forall` → ∀
- 存在：`\exists` → ∃

## 💡 实用示例

### 示例 1：物理公式
```markdown
**爱因斯坦质能方程**

著名的质能方程：$E=mc^2$

其中：
- $E$ 表示能量
- $m$ 表示质量
- $c$ 表示光速（约 $3 \times 10^8$ m/s）
```

### 示例 2：数学定理
```markdown
**勾股定理**

直角三角形的三边关系：

$$a^2 + b^2 = c^2$$

其中 $c$ 是斜边，$a$ 和 $b$ 是直角边。
```

### 示例 3：求和公式
```markdown
**等差数列求和**

前 $n$ 项和公式：

$$\sum_{i=1}^{n} i = \frac{n(n+1)}{2}$$

例如：$1+2+3+\cdots+100 = 5050$
```

### 示例 4：积分公式
```markdown
**高斯积分**

著名的高斯积分：

$$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$$

这是概率论中的重要公式。
```

### 示例 5：矩阵
```markdown
**矩阵表示**

单位矩阵：

$$I = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}$$
```

### 示例 6：分数和根号
```markdown
**二次方程求根公式**

$$x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$$

其中 $a \neq 0$
```

## 🎯 在节目详情中使用

### 1. 编辑节目详情
访问：`http://localhost:3000/admin/programs`

点击任意节目的 **"📝 编辑详情"** 按钮

### 2. 输入公式
在文本框中输入包含公式的内容，例如：

```
**数学主题表演**

表演时长：*20分钟*

我们将展示美丽的数学公式：

圆周率：$\pi \approx 3.14159$

欧拉公式（数学中最美的公式）：

$$e^{i\pi} + 1 = 0$$

**亮点**：
- 用艺术诠释数学
- *互动环节*包含数学游戏
- 适合**所有年龄段**观众
```

### 3. 实时预览
输入后会在预览区看到渲染效果，公式会显示为专业的数学排版

### 4. 保存
点击 **"💾 保存"** 按钮

### 5. Guest端查看
访问：`http://localhost:3000/programs`

点击节目卡片，查看包含公式的详情

## ⚠️ 注意事项

### 1. 公式语法错误
如果公式语法错误，会显示错误提示：
```
公式错误: [你的公式]
```

### 2. 特殊字符转义
在 JSON 文件中，某些字符需要转义：
- 反斜杠：`\\` 
- 例如：`\frac` 在 JSON 中写作 `\\frac`

### 3. 公式与 Markdown 冲突
- 避免在公式中使用 `*` 和 `_`（它们是 Markdown 语法）
- 如需使用，请用 `\times` 代替 `*`
- 下标用 `_` 是安全的，因为在 `$...$` 内部

### 4. 多行公式
块级公式支持多行：
```
$$
\begin{aligned}
  a &= b + c \\
  d &= e + f
\end{aligned}
$$
```

### 5. 空格处理
- 公式内部的空格会被自动处理
- 使用 `\quad` 或 `\qquad` 添加空格
- 使用 `\\` 换行

## 🔧 技术说明

### 使用的库
- **KaTeX**：快速的数学排版库
- 版本：最新版本
- CSS：自动引入 KaTeX 样式

### 渲染流程
1. MarkdownRenderer 组件接收内容
2. 先处理块级公式 `$$...$$`
3. 再处理行内公式 `$...$`
4. 最后处理 Markdown 语法（粗体、斜体）
5. 使用 KaTeX 渲染数学公式
6. 显示最终效果

### 性能优化
- 公式渲染使用 `throwOnError: false`，避免错误导致崩溃
- 使用 `useEffect` 优化渲染时机
- 仅在内容变化时重新渲染

## 📚 更多资源

### KaTeX 官方文档
https://katex.org/docs/supported.html

### 常用公式参考
- 所有支持的函数和符号列表
- LaTeX 数学公式语法
- 更多高级用法

### 在线测试
可以使用在线 KaTeX 编辑器测试公式：
https://katex.org/

## 🎓 学习路径

### 初学者
1. 先学会行内公式 `$...$`
2. 掌握基本符号（上下标、分数、根号）
3. 尝试块级公式 `$$...$$`

### 进阶用户
1. 学习矩阵和方程组
2. 掌握求和、积分符号
3. 使用对齐环境 `\begin{aligned}`

### 高级用户
1. 复杂的多行公式
2. 自定义间距和样式
3. 特殊符号和字体

## 🌟 实用技巧

### 1. 快速输入常用公式
建立常用公式模板：
```
# 常用模板
平方：$x^2$
立方：$x^3$
分数：$\frac{a}{b}$
根号：$\sqrt{x}$
求和：$\sum_{i=1}^{n}$
积分：$\int_{a}^{b}$
```

### 2. 组合使用
```markdown
**表演数据统计**

观众满意度：$95\%$

平均评分：$\frac{4.8}{5.0}$

参与人数：$n > 1000$
```

### 3. 美化排版
```markdown
**数学之美**

黄金比例：$\phi = \frac{1 + \sqrt{5}}{2} \approx 1.618$

这个比例在*自然界*和**艺术作品**中随处可见。
```

---

**提示**：现在你可以在节目详情中添加专业的数学公式，让内容更加丰富多彩！📐✨
